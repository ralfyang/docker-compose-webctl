### 초기 기반 구성용 프롬프트

Go lang을 통해 간단하게 리눅스 시스템을 컨트롤할 수 있는 웹콘솔을 개발하려고 합니다. 

간단하게 회원가입이 가능하고, 로그인한 첫번째 사람이 어드민 권한을 갖습니다.

어드민이 아닐 경우 로그인을 하더라도 어드민 권한이 필요하다는 메시지만 확인이 됩니다.

회원 가입 시, 이메일을 통해 어드민에게 권한 승인 이메일이 발송됩니다.

어드민은 상단 좌측 collapsed menu icon을 통해 권한관리 메뉴를 통해 사용자의 권한을 할당 할 수 있으며, 권한은, ‘어드민’,’권한없음’ 두가지가 존재합니다.

웹을 통해 컨트롤을 하는 대상은 특정 경로의 docker-compose.yml 파일입니다.

웹을 통해 docker-compose.yml 파일의 위치와 파일명을 등록 할 수 있으며, 웹 에디터를 통해 yml 파일 편집을 위한 편집기가 제공됩니다.

편집기를 통해 편집된 파일은 앞에서 지정해둔 파일로 저장이되지만, 기존의 파일명은 [기존파일명_날짜시간초.yml]로 별도로 백업파일을 저장합니다.

파일의 편집을 위해서는 sudo 권한이 있어야 하고, 파일의 저장을 위한 저장 버튼과, 저장과 시스템 리스타트를 동시에 할 수 있는 버튼이 존재합니다.

상단에 “Revision” 버튼을 통해서 지금까지 저장된 백업파일의 리스트를 볼 수 있으며, 백업파일의 리스트를 클릭시 파일을 지정해둔 파일로 롤백할지를 물어보고, ‘예’를 클릭 시, 해당 파일을 지정해둔 docker-compose 파일로 변환 후 도커 시스템을 재시작 합니다.

웹콘솔은 docker-compose 설정파일이 있는 위치에서 docker-compose 재시작 커맨드를 실행 할 수 있습니다.

도커 컴포즈의 재시작 명령어는 docker-compose -f [지정해둔 파일명] down; sleep 2; docker-compose up -d 이며, 해당 도커 컴포즈 파일이 있는 위치에서 실행을 합니다.

사용자 정보는 별도의 DB가 없는 관계로, 현재 디렉토리에 .account 파일로 저장하며, 형식은, 이메일,해시된 비밀번호,어드민 유무 형태로 3개의 인자로 구성해서 적용해주세요

 답변은 한글로 해주시고, 코드를 작성해주세요

docker-compose 설정파일의 수정에 있어서, 경로를 웹콘솔에서 아무곳이나 지정 할 경우 보안상 큰 위험이 될 수 있을것 같습니다. 웹콘솔이 동작하는 하위 디렉토리에 위치한 디렉토리와 그 안에 파일만 터치 할 수 있도록 해야 하겠습니다.
그리고 웹 콘솔은 현재 왼쪽 정렬로 되어있는데, 가운데 정렬로 바꿔주세요. 그리고 보여지는 화면이 좀 더 이뻤으면 좋겠어요.
그리고 backup 파일은 최근 20개만 남기고 20개가 넘어가는 오래된 파일은 삭제해주세요.
백업파일이 삭제가 가능한 만큼 해당 파을을 다운로드 받을 수 있는 버튼도 만들어주세요

/opt/docker-webctl/composefiles 하위 허용 이라는 문구가 필요없이, 웹콘솔이 가동되는 시점에 ./docker-compose-list 디렉토리를 생성하고, 웹 콘솔에서 생성할 디렉토리명을 입력받아 '디렉토리 생성' 이라는 버튼을 통해 해당 디렉토리가 생성되고, 생성할 파일명을 입력 후  파일 생성을 하여 docker-compose 설정 파일 및 prometheus.yml 등의 설정을 생성해서 시스템을 구축 할 수 있도록 하면 좋겠습니다.

코드의 작성 및 유지보수 등을 고려해서 하나의 main.go 파일에 모든 코드를 다 입력할게 아니라, 효율적으로 package 등으로 코드를 분리해서 작성하는것이 어떨까요? Css나 html, javascript  파일 부분도 마찬가지고요.

그리고 도커 컴포즈 리스트 페이지에서는 화면을 분활하여, 왼쪽에는 도커 컴포즈가 있는 경로의 리스트가 나오고, 해당 리스트의 파일을 선택하면, 오른쪽 에디터에서 바로 표시가 되고 수정, 저장, 저장후 리스타트 등이 되게 하면 아주 좋을것 같습니다

![image.png](attachment:c70874d5-7a8b-4e86-b56f-dca98b311a17:image.png)

이런 성공 메시지 보이지 않고 바로 대시보드 화면으로 이동해주세요

![image.png](attachment:1b3f1c2d-971b-4814-9f3b-6f851da41c52:image.png)

로그아웃과 어드민 버튼은 해당 메뉴 버튼 위치가 아닌, 대시보드 보다 상단 오른쪽에 별도로 위치하고, 디렉토리 목 버튼이 아닌 그냥 해당 목록이 현재 화면에 노출 되도록 수정해주세요

![image.png](attachment:d8b2524a-3067-4c4a-9b28-fff8664c41b0:image.png)

어드민 페이지에서는 “사용자관리”, “디렉토리 목록” 등의 서브 페이지가 아닌 사용자관리 페이지의 내용과, 디렉토리 목록을 동시에 한 페이지에 표시되게 수정해주세요

![image.png](attachment:f1aa1d3b-73c6-495b-90cf-a7478395ae9a:image.png)

여전히 docker-compose-list/test_run/docker-controller.sh 파일이 없다는 에러가 나옵니다 docker-controller.sh 파일을 새롭게 생성된 디렉토리로 복사해서 실행될 수 있도록 해주세요

### 초안 작성 후 업데이트 진행

하지만 화면 구성이 UX적으로 너무 불편합니다. 따라서 해당 첨부이미지와 같이,
Landing page에는 바로 로그인 할수 있는 입력창과, 회원이 아닐 경우, 회원가입 페이지로 갈 수 있는 버튼을 별도로 만들어서 처리하고,
회원가입 페이지에서 회원 가입이 완료 된 후에는 바로 도커 컴포즈 웹콘솔 화면으로 이동하게 해주세요. 단, admin이 아닐 경우 해당 페이지는 Admin의 권한 부여가 필요하다는 메시지등이 노출 되도록 보안이 필요합니다.

도커 컴포즈 웹콘솔 화면은, 디렉토리 생성과, 생성된 디렉토리를 클릭했을 경우, 디렉토리 내부의  파일 리스트를 볼 수 있습니다.
또한 해당 디렉토리에 파일 생성을 하여, 해당 파일을 클릭 시 하단 에디터를 통해 수정이 가능합니다.

마찬가지로, 수정 또는 생성된 파일을 해당 디렉토리에 저장할 수 있으며, 새로운 업데이트가 저장 될 경우, 해당 디렉토리 하위에 Backup 이라는 디렉토리를 생성하여 저장되는 일자와시간을 기준으로 파일명을 작성하여 백업파일을 저장합니다.

마찬가지로 docker-compose를 restart 할 수 있는 버튼이 있으며, 이부분은 "저장 & 리스타트" 버튼으로 처리됩니다.

또 달라지는 부분은 어드민 페이지인데, 이 부분은 도커컴포즈 웹콘솔 우측 상단에 버튼이 위치하며, 버튼 클릭시 팝업창을 통해 사용자에게 권한을 할당하는 페이지로 이동하여 권한을 부여 할 수 있습니다.

마지막으로 각 페이지 하단에는 "로그아웃" 버튼이 존재합니다.

main.go 코드에서 설정파일을 추출해서 별도로 관리하고자 합니다.
.env 파일을 생성해서,
port="15500"
docker_id=""
docker_password=""

등의 설정값을 따로 분리해서 컴파일된 dc_webconsole 실행파일로 서버를 가동 할 수 있도록 아래 코드를 수정해주세요.

또한 dc_webconsole 실행파일은,
dc_webconsole start 파라메터 형태로 서버 데몬를 가동하고,
dc_webconsole stop 형태로 서버 데몬을 중지하고,
dc_webconsole run 형태로 런타임 형태로 서버를 볼수 있도록 수정하고,
서버 데몬 형태로 동작시에 dc_webconsole.log 파일을 생성해서 로그를 기록 할 수 있도록 해주세요

### 제거

웹콘솔은 golang으로 만들어지지만, golang이 실행하는 파일은 별도의 [docker-controller.sh](http://docker-controller.sh) 라는 bash 파일을 생성 후 진행하려고 합니다.

### 초안 화면

![image.png](attachment:1571e74d-1fdc-4a9e-b966-c08087bc5d25:image.png)

![image.png](attachment:b0b08027-b99f-4a0a-aa42-2bcaf4b77034:image.png)

### 실행 테스트

- root로 실행 시 docker-compose 컨트롤 가능

![image.png](attachment:9d776279-edf0-4f70-9620-63b837eefc23:image.png)
